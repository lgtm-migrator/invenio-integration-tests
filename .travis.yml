# -*- coding: utf-8 -*-
#
# Copyright (C) 2020 CESNET.
#
# invenio-integration-tests is free software; you can redistribute it and/or modify it
# under the terms of the MIT License; see LICENSE file for more details.

language: python
python:
  - "3.8"
  
notifications:
  email: # sent to the committer and the author
    on_success: never # default: always
    on_failure: never # default: always   #TODO: change to always

branches:
  only:
  - master

env:
  global:
    - E2E=no
  matrix:
    - REQUIREMENTS=test EXTRAS=invenio3.2

cache: pip

#addons:
#  postgresql: 9.6

#services:
#  - postgresql
#  - redis
#  - rabbitmq

before_install:
  # Stop default travis services
  - "sudo service mysql stop"
  - "./scripts/init ${EXTRAS}"

install:
  - "./scripts/bootstrap"

script:
  - ./run_tests.sh

deploy:
  provider: releases
  api_key:
    secure: "FJPw2IHfYg7L94ciiR9JsCnUdn3e0ZAVhdX8ZIRyYjIv/kK42IVgBq/Jy8L/u+yR+CtYDLL6crsOoRB3hnkSgDUfl+iiexzrzYgqUBNzY/eRWrFRras/kmDGz9AteYmYbxQEGPxGw8D8r1wLk/5ABki5Em09BD9vORWGsB0tJeAYJdbHEXc1j+VZjGoZjxXMXE7sEX3PIaZgHXkP+idIrmiwgcFgRGAersvOA9ZKlY2FRhujPAA3rfCexzF2HimZb2LMLm18usGpdCx9LLqOnWs/VVgM6la2yTONWopMCZJlxynwwEWVuHzFKlLCPYjnXc+LohtTZ9usYEm2WsnzXx5cf4XdLcj4CHwJBihI1f3XD4aslyvPkF85J5RtcBQ5cUVvYnKltpkQRVhHCj8JDtofUTa/i/aBvR0hPwdCJqT9jqdd6FWQPJhralIlv7b00ZDu0+A/6xT5GlLyix0uYJ4WeEk18rxk2fgRSB/gLaj3YLHBcrCVObTDMdUBLB3KESrQqndkuUYgRf8dwZWqMpbQ9ZFs8R8kiW5Sl/IiyCDETrzK0XeIEFrZU0DLXIw7VDpH3G4J+XCFqOptASm8W8QQhhefZYoA/FdlEhN0q/BNg4Ju27LrAPOxAayZw3DC+m7Ng9/ppAtpMDmvEjZ85G2F1nDoIoCQVz4EsSWYY0k="
  file: ".requirements.txt"
  skip_cleanup: true
  draft: true
  overwrite: true
